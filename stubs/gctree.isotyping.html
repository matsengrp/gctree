<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gctree.isotyping &mdash; gctree  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="gctree.isotyping.explode_idmap" href="gctree.isotyping.explode_idmap.html" />
    <link rel="prev" title="gctree.utils.product" href="gctree.utils.product.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing gctree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rendering-demo.html">Custom tree visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">gctree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html#parsimony-utilities">Parsimony utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html#isotype">isotype</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api.html">Classes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html#modules">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gctree.mutation_model.html">gctree.mutation_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gctree.utils.html">gctree.utils</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">gctree.isotyping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gctree.isotyping.explode_idmap.html">gctree.isotyping.explode_idmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.isotyping.isotype_distance.html">gctree.isotyping.isotype_distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.isotyping.isotype_parsimony.html">gctree.isotyping.isotype_parsimony</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.isotyping.isotype_tree.html">gctree.isotyping.isotype_tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.isotyping.Isotype.html">gctree.isotyping.Isotype</a></li>
<li class="toctree-l3"><a class="reference internal" href="gctree.isotyping.IsotypeTemplate.html">gctree.isotyping.IsotypeTemplate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gctree.isotyping.IsotypeTemplate"><code class="docutils literal notranslate"><span class="pre">IsotypeTemplate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.IsotypeTemplate.__init__"><code class="docutils literal notranslate"><span class="pre">IsotypeTemplate.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.IsotypeTemplate.new"><code class="docutils literal notranslate"><span class="pre">IsotypeTemplate.new()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gctree.isotyping.Isotype"><code class="docutils literal notranslate"><span class="pre">Isotype</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.Isotype.order"><code class="docutils literal notranslate"><span class="pre">Isotype.order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.Isotype.weight_matrix"><code class="docutils literal notranslate"><span class="pre">Isotype.weight_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.Isotype.isotype"><code class="docutils literal notranslate"><span class="pre">Isotype.isotype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.Isotype.__init__"><code class="docutils literal notranslate"><span class="pre">Isotype.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#gctree.isotyping.Isotype.resolutions"><code class="docutils literal notranslate"><span class="pre">Isotype.resolutions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gctree.isotyping.isotype_tree"><code class="docutils literal notranslate"><span class="pre">isotype_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gctree.isotyping.isotype_distance"><code class="docutils literal notranslate"><span class="pre">isotype_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gctree.isotyping.isotype_parsimony"><code class="docutils literal notranslate"><span class="pre">isotype_parsimony()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gctree.isotyping.explode_idmap"><code class="docutils literal notranslate"><span class="pre">explode_idmap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gctree.branching_processes.html">gctree.branching_processes</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Open source code repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html#developer-tools">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html#todo-list">Todo list</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gctree</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">Classes</a> &raquo;</li>
      <li>gctree.isotyping</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-gctree.isotyping">
<span id="gctree-isotyping"></span><h1>gctree.isotyping<a class="headerlink" href="#module-gctree.isotyping" title="Permalink to this heading"></a></h1>
<p>A module for incorporating isotype information in gctree inference.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="gctree.isotyping.explode_idmap.html#gctree.isotyping.explode_idmap" title="gctree.isotyping.explode_idmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explode_idmap</span></code></a></p></td>
<td><p>Uses provided mapping of original sequence IDs to observed isotypes to 'explode' the provided mapping of unique sequence IDs to original sequence IDs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="gctree.isotyping.isotype_distance.html#gctree.isotyping.isotype_distance" title="gctree.isotyping.isotype_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isotype_distance</span></code></a></p></td>
<td><p>Returns the weight of the transition from isotype <code class="docutils literal notranslate"><span class="pre">t1</span></code> to isotype <code class="docutils literal notranslate"><span class="pre">t2</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="gctree.isotyping.isotype_parsimony.html#gctree.isotyping.isotype_parsimony" title="gctree.isotyping.isotype_parsimony"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isotype_parsimony</span></code></a></p></td>
<td><p>Computes the sum of <a class="reference internal" href="gctree.isotyping.isotype_distance.html#gctree.isotyping.isotype_distance" title="gctree.isotyping.isotype_distance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isotype_distance()</span></code></a> along each edge in an isotyped tree.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="gctree.isotyping.isotype_tree.html#gctree.isotyping.isotype_tree" title="gctree.isotyping.isotype_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isotype_tree</span></code></a></p></td>
<td><p>Method adds isotypes to <code class="docutils literal notranslate"><span class="pre">tree</span></code>, minimizing isotype switching and obeying switching order.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="gctree.isotyping.Isotype.html#gctree.isotyping.Isotype" title="gctree.isotyping.Isotype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Isotype</span></code></a></p></td>
<td><p>An isotype, and associated information about class switching order and transition weights.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="gctree.isotyping.IsotypeTemplate.html#gctree.isotyping.IsotypeTemplate" title="gctree.isotyping.IsotypeTemplate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IsotypeTemplate</span></code></a></p></td>
<td><p>A template constructor class for <a class="reference internal" href="gctree.isotyping.Isotype.html#gctree.isotyping.Isotype" title="gctree.isotyping.Isotype"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Isotype()</span></code></a></p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="gctree.isotyping.IsotypeTemplate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gctree.isotyping.</span></span><span class="sig-name descname"><span class="pre">IsotypeTemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isotype_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#IsotypeTemplate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.IsotypeTemplate" title="Permalink to this definition"></a></dt>
<dd><p>A template constructor class for <a class="reference internal" href="gctree.isotyping.Isotype.html#gctree.isotyping.Isotype" title="gctree.isotyping.Isotype"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Isotype()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isotype_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A list or other Sequence of isotype names, in the allowed class switching order</p></li>
<li><p><strong>weight_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]]) – An optional matrix containing transition weights between isotypes. Default weight is 1 for all allowed isotype transitions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gctree.isotyping.IsotypeTemplate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isotype_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#IsotypeTemplate.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.IsotypeTemplate.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.isotyping.IsotypeTemplate.new">
<span class="sig-name descname"><span class="pre">new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isotype_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#IsotypeTemplate.new"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.IsotypeTemplate.new" title="Permalink to this definition"></a></dt>
<dd><p>Return an <a class="reference internal" href="gctree.isotyping.Isotype.html#gctree.isotyping.Isotype" title="gctree.isotyping.Isotype"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Isotype()</span></code></a> object with the isotype order and weight
matrix provided to this class’s constructor.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gctree.isotyping.Isotype">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gctree.isotyping.</span></span><span class="sig-name descname"><span class="pre">Isotype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotype_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#Isotype"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.Isotype" title="Permalink to this definition"></a></dt>
<dd><p>An isotype, and associated information about class switching order and
transition weights.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="gctree.isotyping.Isotype.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#gctree.isotyping.Isotype.order" title="Permalink to this definition"></a></dt>
<dd><p>A list or other sequence of isotype names, in their allowed class switching order</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gctree.isotyping.Isotype.weight_matrix">
<span class="sig-name descname"><span class="pre">weight_matrix</span></span><a class="headerlink" href="#gctree.isotyping.Isotype.weight_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Transition weights between isotypes, with first index the original isotype index, and second index the new isotype index.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gctree.isotyping.Isotype.isotype">
<span class="sig-name descname"><span class="pre">isotype</span></span><a class="headerlink" href="#gctree.isotyping.Isotype.isotype" title="Permalink to this definition"></a></dt>
<dd><p>Index of isotype name in <code class="docutils literal notranslate"><span class="pre">self.order</span></code></p>
</dd></dl>

<p>Objects of this class shall be instantiated using <a class="reference internal" href="gctree.isotyping.IsotypeTemplate.html#gctree.isotyping.IsotypeTemplate.new" title="gctree.isotyping.IsotypeTemplate.new"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IsotypeTemplate.new()</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gctree.isotyping.Isotype.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotype_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#Isotype.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.Isotype.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gctree.isotyping.Isotype.resolutions">
<span class="sig-name descname"><span class="pre">resolutions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#Isotype.resolutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.Isotype.resolutions" title="Permalink to this definition"></a></dt>
<dd><p>Returns list of all possible isotypes if passed an ambiguous
isotype.</p>
<p>Otherwise, returns a list containing a copy of the passed
isotype.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference internal" href="gctree.isotyping.Isotype.html#gctree.isotyping.Isotype" title="gctree.isotyping.Isotype"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotype</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gctree.isotyping.isotype_tree">
<span class="sig-prename descclassname"><span class="pre">gctree.isotyping.</span></span><span class="sig-name descname"><span class="pre">isotype_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newidmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotype_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#isotype_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.isotype_tree" title="Permalink to this definition"></a></dt>
<dd><p>Method adds isotypes to <code class="docutils literal notranslate"><span class="pre">tree</span></code>, minimizing isotype switching and
obeying switching order.</p>
<ul class="simple">
<li><p>Adds observed isotypes to each observed node in the collapsed
trees output by gctree inference. If cells with the same sequence
but different isotypes are observed, then collapsed tree nodes
must be ‘exploded’ into new nodes with the appropriate isotypes
and abundances. Each unique sequence ID generated by gctree is
prepended to its observed isotype, and a new <cite>isotyped.idmap</cite>
mapping these new sequence IDs to original sequence IDs is
written in the output directory.</p></li>
<li><p>Resolves isotypes of unobserved ancestral genotypes in a way
that minimizes isotype switching and obeys isotype switching
order. If observed isotypes of an observed internal node and its
children violate switching order, then the observed internal node
is replaced with an unobserved node with the same sequence, and
the observed internal node is placed as a child leaf. This
procedure always allows switching order conflicts to be resolved,
and should usually increase isotype transitions required in the
resulting tree.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>) – ete3 Tree</p></li>
<li><p><strong>newidmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – mapping of sequence IDs to isotypes, such as that output by <code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.explode_idmap()</span></code>.</p></li>
<li><p><strong>isotype_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – list or other sequence of isotype names observed, in correct switching order.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A new ete3 Tree whose nodes have isotype annotations in the attribute <code class="docutils literal notranslate"><span class="pre">isotype</span></code>.
Node names in this tree also contain isotype names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gctree.isotyping.isotype_distance">
<span class="sig-prename descclassname"><span class="pre">gctree.isotyping.</span></span><span class="sig-name descname"><span class="pre">isotype_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#isotype_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.isotype_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns the weight of the transition from isotype <code class="docutils literal notranslate"><span class="pre">t1</span></code> to isotype
<code class="docutils literal notranslate"><span class="pre">t2</span></code>.</p>
<p>This function is not symmetric on its arguments, so isn’t a true
distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gctree.isotyping.isotype_parsimony">
<span class="sig-prename descclassname"><span class="pre">gctree.isotyping.</span></span><span class="sig-name descname"><span class="pre">isotype_parsimony</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#isotype_parsimony"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.isotype_parsimony" title="Permalink to this definition"></a></dt>
<dd><p>Computes the sum of <a class="reference internal" href="gctree.isotyping.isotype_distance.html#gctree.isotyping.isotype_distance" title="gctree.isotyping.isotype_distance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isotype_distance()</span></code></a> along each edge in an
isotyped tree.</p>
<p>If no weight matrix was provided during isotyping of the tree, then
the return value of this function is the number of isotype
transitions along edges in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gctree.isotyping.explode_idmap">
<span class="sig-prename descclassname"><span class="pre">gctree.isotyping.</span></span><span class="sig-name descname"><span class="pre">explode_idmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotype_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gctree/isotyping.html#explode_idmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gctree.isotyping.explode_idmap" title="Permalink to this definition"></a></dt>
<dd><p>Uses provided mapping of original sequence IDs to observed isotypes to
‘explode’ the provided mapping of unique sequence IDs to original sequence
IDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Set" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Set</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A dictionary mapping unique sequence IDs to sets of original IDs of observed sequences</p></li>
<li><p><strong>isotype_map</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A dictionary mapping original IDs to observed isotype names</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Set" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Set</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary mapping unique sequence IDs to dictionaries, mapping isotype names to sets of original sequence IDs.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gctree.utils.product.html" class="btn btn-neutral float-left" title="gctree.utils.product" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gctree.isotyping.explode_idmap.html" class="btn btn-neutral float-right" title="gctree.isotyping.explode_idmap" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, William DeWitt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>